<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
  Euroleague Pythagorean Expectation · Timur Kulenović
</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Timur Kulenović">
<meta name="description" content="What is Pythagorean expectation? Link to heading Pythagorean expectation is a formula that was originally derived by Bill James to be used in baseball. The objective of the formula was to estimate how many wins a team should have won based on the number of scored runs and allowed runs. You can read more about the theorem on Wikipedia and this article that also presents few practical examples. Originally the form of the formula looks like this: $$W \approx \frac{(\text{scored runs}) ^ 2}{(\text{scored runs}) ^ 2 &#43; (\text{allowed runs}) ^ 2}\text{,}$$ where $W$ is the ratio of team&rsquo;s wins or winning ratio.">
<meta name="keywords" content="">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Euroleague Pythagorean Expectation"/>
<meta name="twitter:description" content="What is Pythagorean expectation? Link to heading Pythagorean expectation is a formula that was originally derived by Bill James to be used in baseball. The objective of the formula was to estimate how many wins a team should have won based on the number of scored runs and allowed runs. You can read more about the theorem on Wikipedia and this article that also presents few practical examples. Originally the form of the formula looks like this: $$W \approx \frac{(\text{scored runs}) ^ 2}{(\text{scored runs}) ^ 2 &#43; (\text{allowed runs}) ^ 2}\text{,}$$ where $W$ is the ratio of team&rsquo;s wins or winning ratio."/>

<meta property="og:title" content="Euroleague Pythagorean Expectation" />
<meta property="og:description" content="What is Pythagorean expectation? Link to heading Pythagorean expectation is a formula that was originally derived by Bill James to be used in baseball. The objective of the formula was to estimate how many wins a team should have won based on the number of scored runs and allowed runs. You can read more about the theorem on Wikipedia and this article that also presents few practical examples. Originally the form of the formula looks like this: $$W \approx \frac{(\text{scored runs}) ^ 2}{(\text{scored runs}) ^ 2 &#43; (\text{allowed runs}) ^ 2}\text{,}$$ where $W$ is the ratio of team&rsquo;s wins or winning ratio." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kulenovic.si/projects/pythagorean/" /><meta property="article:section" content="projects" />
<meta property="article:published_time" content="2022-10-24T20:00:00+02:00" />
<meta property="article:modified_time" content="2022-10-24T20:00:00+02:00" />





<link rel="canonical" href="https://kulenovic.si/projects/pythagorean/">



	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" integrity="sha384-Juol1FqnotbkyZUT5Z7gUPjQ9gzlwCENvUZTpQBAPxtusdwFLRy382PSDx5UUJ4/" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js" integrity="sha384-97gW6UIJxnlKemYavrqDHSX3SiygeOwIZhwyOKRfSaf0JWKRVj9hLASHgFTzT+0O" crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>


<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: true}
            ]
        });
    });
</script>



<link rel="preload" href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.c4d7e93a158eda5a65b3df343745d2092a0a1e2170feeec909b8a89443903c6a.css" integrity="sha256-xNfpOhWO2lpls980N0XSCSoKHiFw/u7JCbiolEOQPGo=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.78b5fe3864945faf5207fb8fe3ab2320d49c3365def0e88ac1df0ddadc54a03c.css" integrity="sha256-eLX&#43;OGSUX69SB/uP46sjINScM2Xe8OiKwd8N2txUoDw=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">




<meta name="generator" content="Hugo 0.102.0" />





  </head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      Timur Kulenović
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="/projects/">Projects</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="/cv/">CV</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="https://kulenovic.si/projects/pythagorean/">
          Euroleague Pythagorean Expectation
        </a>
      </h1>
    </header>

    <h2 id="what-is-pythagorean-expectation">
  What is Pythagorean expectation?
  <a class="heading-link" href="#what-is-pythagorean-expectation">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Pythagorean expectation is a formula that was originally derived by Bill James to be used in baseball. The objective of the formula was to estimate how many wins a team should have won based on the number of <em>scored runs</em> and <em>allowed runs</em>. You can read more about the theorem on <a href="https://en.wikipedia.org/wiki/Pythagorean_expectation">Wikipedia</a> and <a href="https://towardsdatascience.com/pythagorean-expectation-in-sports-analytics-with-examples-from-different-sports-f5e599530a6c">this article</a> that also presents few practical examples. Originally the form of the formula looks like this:
$$W \approx \frac{(\text{scored runs}) ^ 2}{(\text{scored runs}) ^ 2 + (\text{allowed runs}) ^ 2}\text{,}$$
where $W$ is the ratio of team&rsquo;s wins or <strong>winning ratio</strong>.</p>
<p>However, we can generalize the above formula to other sports. If we use general notation, where $P_F$ denotes <em>points for</em> and $P_A$ denotes <em>points against</em>, then formula then converts to:</p>
<p>$$
W \approx \frac{{P_F} ^ x}{P_F ^ x + P_A ^ x} \text{.}
$$</p>
<p>Notice that in the second formula the exponents are not defined. As seen in the first formula for baseball, Bill James used $x = 2$. Later there were some corrections for baseball to set $x = 1.83$. The value of $x$ depends on the nature of the sport. In football we see significantly lower number of points (goals) scored in comparison to basketball, so in order for the formula to be a good estimator of winning ratio we need to set the $x$ value correctly, which will be explained later on.</p>
<h2 id="pythagorean-expectation-applied-to-euroleague">
  Pythagorean expectation applied to Euroleague
  <a class="heading-link" href="#pythagorean-expectation-applied-to-euroleague">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>In this article I will demonstrate how well Pythagorean theorem applies to basketball, specifically to the strongest european competition of Turkish Airlines Euroleague.</p>
<p>For the analysis I used seasons of 2016/2017, 2017/2018, 2018/2019 and 2020/2021.</p>
<p>Let&rsquo;s draw a plot of Pythagorean expectation vs. $W$ for each team in listed seasons. Here, I used $x = 2$ just to show that we can also draw conclusions using the <em>original</em> $x$ value:</p>
<p><a href="/pythagorean-exp-intro_files/pyth_classic.png"><img src="/pythagorean-exp-intro_files/pyth_classic.png" alt="Pythagorean expectation classic"></a></p>
<p>We observe that the values on vertical and horizontal axis are not in the same range, therefore we conclude that the $x = 2$ is not the best setting for this data. However, there definitely is a linear relationship between winning ratio and Pythagorean expectation. The green line in plots presents the line obtained by linear regression. Furthermore, I calculated Pearson correlation coefficients to confirm the linear relationship:</p>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>season</th>
      <th>corr. coef.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2016/17</td>
      <td>0.954</td>
    </tr>
    <tr>
      <td>2017/18</td>
      <td>0.887</td>
    </tr>
    <tr>
      <td>2018/19</td>
      <td>0.963</td>
    </tr>
    <tr>
      <td>2020/21</td>
      <td>0.945</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="finding-the-best-exponent">
  Finding the best exponent
  <a class="heading-link" href="#finding-the-best-exponent">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>We observed that there is obvious correlation between Pythagorean expectation and winning ratio, however $x = 2$ is not the choice to directly estimate $W$ from points. To get the best fit for $x$ I constructed simple loss function:
$$
L(x) = \frac{\sum_{i=1}^n | W_i - \frac{{P_{F_i}} ^ x}{P_{F_i} ^ x + P_{A_i} ^ x}|}{n} \text{.}
$$
The loss function minimizes the average difference between winning ratio and Pythagorean expectation across all teams with respect to parameter $x$. For loss function minimization I used function <code>fmin_l_bfgs_b</code> from <code>scipy</code> library. The values were calculated for each season separately:</p>


<div>
<style scoped>
    .dataframe {
      margin-left:  auto;
      margin-right: auto;
    }
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Season</th>
      <th>Best x</th>
      <th>Loss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2016/17</td>
      <td>11.24</td>
      <td>0.034</td>
    </tr>
    <tr>
      <td>2017/18</td>
      <td>10.95</td>
      <td>0.056</td>
    </tr>
    <tr>
      <td>2018/19</td>
      <td>11.03</td>
      <td>0.039</td>
    </tr>
    <tr>
      <td>2020/21</td>
      <td>11.10</td>
      <td>0.041</td>
    </tr>
  </tbody>
</table>
</div>

<p>The best fits for each of four seasons are pretty similar, $x \approx 11$. It could be that the $L(x)$ has multiple local minima and <code>fmin_l_bfgs_b</code> might not have returned the global minimum. We can verify that these $x$ values are indeed the best fit with respect to $L(x)$ using brute force by simply evaluating function on range $x$ = [0, 30] with step of 0.05.</p>
<p><a href="/pythagorean-exp-intro_files/errors.png"><img src="/pythagorean-exp-intro_files/errors.png" alt="png"></a></p>
<p>These seem to be convex functions, so there should not be any problems getting the smallest loss using any of the two methods. Quick glance at plots suffices to confirm that $x \approx 11$ seems to be a good fit for this data, however we also can also show values obtained using this method:</p>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Season</th>
      <th>Best x</th>
      <th>Loss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2016/17</td>
      <td>11.25</td>
      <td>0.034</td>
    </tr>
    <tr>
      <td>2017/18</td>
      <td>10.95</td>
      <td>0.056</td>
    </tr>
    <tr>
      <td>2018/19</td>
      <td>11.00</td>
      <td>0.039</td>
    </tr>
    <tr>
      <td>2020/21</td>
      <td>11.10</td>
      <td>0.041</td>
    </tr>
  </tbody>
</table>
</div>

<p>Comparing both tables, we conclude that the values are more or less identical and therefore both methods are adequate for finding the best value for parameter $x$.</p>
<h3 id="utilizing-the-chosen-x">
  Utilizing the chosen $x$
  <a class="heading-link" href="#utilizing-the-chosen-x">
    <i class="fa fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Finally, we use the obtained $x$ values, to adjust the Pythagorean expectation in order to get the best fit for given data. Note that the green line in this case does not represent the line obtained using linear regression, it is simply just $y = x$ line.</p>
<p><a href="/pythagorean-exp-intro_files/pyth_fitted.png"><img src="/pythagorean-exp-intro_files/pyth_fitted.png" alt="png"></a></p>
<p>Again, we confirm strong linear correlation between Pythagorean expectation and winning ratio:</p>


<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>season</th>
      <th>corr. coef.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2016/17</td>
      <td>0.956</td>
    </tr>
    <tr>
      <td>2017/18</td>
      <td>0.884</td>
    </tr>
    <tr>
      <td>2018/19</td>
      <td>0.967</td>
    </tr>
    <tr>
      <td>2020/21</td>
      <td>0.944</td>
    </tr>
  </tbody>
</table>
</div>

<p>Here, the interpretation of the plots should be the following: the teams that are above the line managed to win fewer games than expected, considering the number of scored points and allowed points. The teams that are below the line managed to win more games than expected.</p>
<p>Few interpretations:</p>
<ul>
<li>In 2017/2018 Barcelona finished 13th, however they definitely had potential to reach the Top 8.</li>
<li>In 2020/2021 Fenerbahce finished 7th with winning ratio close to 0.6, but it seems that they had some luck on their side. Their expected winning ratio is below 0.5, which would leave them without Top 8.</li>
</ul>
<p>You can find all the code for this article in <a href="https://github.com/timurkulenovic/basketball-pythagorean-expectation">Github repository</a>.</p>

  </article>
</section>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"
    integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs" crossorigin="anonymous">
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"
    integrity="sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js"
    integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body,
      {
        delimiters: [
          {left: '$$', right: '$$', display:true},
          {left: '$', right: '$', display:false},
          {left: '\\(', right: '\\)', display: false},
          {left: '\\[', right: '\\]', display: true}
        ]
      }
    );"></script>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2022
     Timur Kulenović 
    ·
    
    Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.236049395dc3682fb2719640872958e12f1f24067bb09c327b233e6290c7edac.js" integrity="sha256-I2BJOV3DaC&#43;ycZZAhylY4S8fJAZ7sJwyeyM&#43;YpDH7aw="></script>
  

  

  

  

  

  

  

  

  

  
</body>

</html>
